<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Video Nsfw</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <style>
    :root { --ink:#0d141c }
    body { font-family: 'Inter', sans-serif; }
    .chip { @apply inline-flex items-center gap-2 px-3 py-1.5 rounded-full border bg-white text-sm cursor-default; }
    .chip button { @apply inline-flex items-center justify-center w-5 h-5 rounded-full border; }
  </style>
</head>
<body class="min-h-screen bg-slate-100 text-[var(--ink)]">
  <!-- Top Bar -->
  <header class="w-full bg-white border-b px-6 py-4 flex justify-between items-center">
    <h1 class="text-xl font-bold">Stitch Dashboard</h1>
    <nav class="space-x-4">
      <a href="index.html" class="text-blue-600 hover:underline">Home</a>
      <a href="overview.html" class="text-blue-600 hover:underline">Overview</a>
      <a href="settings.html" class="text-blue-600 hover:underline">Settings</a>
      <a href="studio.html" class="text-blue-600 hover:underline">Studio</a>
    </nav>
  </header>

  <!-- Layout -->
  <main class="p-6">
    <h2 class="text-2xl font-semibold mb-4">Video Nsfw</h2>

    <div class="grid grid-cols-1 xl:grid-cols-[320px,1fr] gap-6">
      <!-- LEFT: Spezifische Einstellungen -->
      <aside class="bg-white rounded-xl shadow border p-4 space-y-4">
        <h3 class="text-lg font-semibold">Allgemeine Einstellungen</h3>

        <div class="space-y-1">
          <label class="text-sm font-medium">Modell</label>
          <select id="model" class="w-full">
            <option value="firefly-video-beta">Firefly Video (beta)</option>
            <option value="sdxl-video">SDXL-Video</option>
            <option value="pika">Pika</option>
            <option value="hunyuan-video">Hunyuan Video</option>
          </select>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="text-sm font-medium">Videoformat</label>
            <select id="aspect" class="w-full">
              <option value="16:9">Breitbild (16:9)</option>
              <option value="9:16">Hochformat (9:16)</option>
              <option value="1:1">Quadrat (1:1)</option>
              <option value="4:3">Klassisch (4:3)</option>
            </select>
          </div>
          <div>
            <label class="text-sm font-medium">FPS</label>
            <select id="fps" class="w-full">
              <option>24</option><option>30</option><option>48</option><option>60</option>
            </select>
          </div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="text-sm font-medium">Dauer (s)</label>
            <input id="duration" type="number" min="1" max="30" value="6" class="w-full" />
          </div>
          <div>
            <label class="text-sm font-medium">Seed</label>
            <input id="seed" type="number" placeholder="zufällig" class="w-full" />
          </div>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="text-sm font-medium">Auflösung</label>
            <select id="resolution" class="w-full">
              <option value="768x432">768×432</option>
              <option value="1280x720">1280×720 (HD)</option>
              <option value="1920x1080" selected>1920×1080 (FHD)</option>
              <option value="2048x1152">2048×1152</option>
            </select>
          </div>
          <div>
            <label class="text-sm font-medium">Qualität</label>
            <select id="quality" class="w-full">
              <option>Entwurf</option>
              <option selected>Standard</option>
              <option>Hoch</option>
            </select>
          </div>
        </div>

        <div class="space-y-1">
          <label class="text-sm font-medium">Kameraparameter</label>
          <div class="grid grid-cols-2 gap-3">
            <input id="fov" type="number" placeholder="FOV (mm)" class="w-full" />
            <select id="camMove" class="w-full">
              <option value="">Keine Bewegung</option>
              <option value="pan">Pan (Links/Rechts)</option>
              <option value="tilt">Tilt (Hoch/Runter)</option>
              <option value="dolly">Dolly (vor/zurück)</option>
            </select>
          </div>
        </div>

        <div class="space-y-1">
          <label class="text-sm font-medium">Stile/Looks</label>
          <div class="flex flex-wrap gap-2" id="styleChips">
            <!-- gefüllte Beispiele -->
            <span class="chip">cinematic</span>
            <span class="chip">soft lighting</span>
            <span class="chip">ultra realistic</span>
          </div>
          <div class="flex gap-2 mt-2">
            <input id="styleInput" class="flex-1" placeholder="Stil hinzufügen…">
            <button id="addStyle" class="px-3 py-2 rounded-lg border bg-slate-50">Add</button>
          </div>
        </div>

        <div class="flex items-center justify-between border-t pt-3">
          <label class="text-sm font-medium">Safety (NSFW freischalten)</label>
          <input id="nsfw" type="checkbox" class="h-5 w-5 accent-rose-600" checked />
        </div>

        <p class="text-xs text-slate-500">Hinweis: Diese Seite ist für 18+ Inhalte vorgesehen. Es werden keine Filter simuliert – Backend-Policy entscheidet.</p>
      </aside>

      <!-- RIGHT: Preview oben rechts, darunter Prompt + Kategorien -->
      <section class="space-y-6">
        <!-- Preview Card -->
        <div class="bg-white rounded-xl shadow border p-4">
          <div class="flex items-center justify-between mb-3">
            <h3 class="text-lg font-semibold">Preview</h3>
            <div class="text-sm text-slate-500" id="previewMeta">1920×1080 • 24fps • 6s</div>
          </div>

          <!-- Video/Image Placeholder -->
          <div class="aspect-video w-full bg-slate-200 rounded-lg overflow-hidden flex items-center justify-center relative">
            <video id="previewVideo" class="w-full h-full hidden" controls></video>
            <img id="previewImage" alt="Preview" class="w-full h-full object-cover"
                 src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1920&auto=format&fit=crop" />
            <button id="swapPreview" class="absolute bottom-3 right-3 px-3 py-1.5 rounded-lg bg-white/90 border text-sm">Bild/Video wechseln</button>
          </div>

          <div class="mt-3 flex gap-2">
            <button id="btnPlay" class="px-4 py-2 rounded-lg bg-black text-white">Abspielen</button>
            <button id="btnDownload" class="px-4 py-2 rounded-lg border">Download</button>
          </div>
        </div>

        <!-- Prompt + Kategorien -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- Prompt Card -->
          <div class="bg-white rounded-xl shadow border p-4">
            <h3 class="text-lg font-semibold mb-3">Prompt</h3>
            <textarea id="prompt" rows="7" class="w-full"
              placeholder="Präzise Videobeschreibung… (z.B. cinematic close-up portrait at golden hour, soft rim light, ultra realistic, cat in sunflower field, camera doesn’t move)"></textarea>

            <label class="text-sm font-medium mt-3 block">Negative Prompt</label>
            <input id="neg" class="w-full" placeholder="artefacts, flicker, jitter, low quality…" />

            <div class="flex flex-wrap items-center gap-2 mt-4">
              <button id="btnGenerate" class="px-4 py-2 rounded-lg bg-rose-600 text-white">Generieren</button>
              <button id="btnStop" class="px-4 py-2 rounded-lg border">Stop</button>
              <span class="text-xs text-slate-500">Senden: Strg+Enter</span>
            </div>
            <div id="status" class="mt-3 text-sm text-slate-600"></div>
          </div>

          <!-- Dynamische Kategorien -->
          <div class="bg-white rounded-xl shadow border p-4">
            <h3 class="text-lg font-semibold mb-3">Dynamische Kategorien</h3>

            <div class="space-y-2">
              <label class="text-sm font-medium">Schnellauswahl</label>
              <div class="flex flex-wrap gap-2" id="quickCats">
                <!-- Beispiele -->
                <button class="px-3 py-1.5 rounded-lg border bg-slate-50" data-cat="solo">solo</button>
                <button class="px-3 py-1.5 rounded-lg border bg-slate-50" data-cat="couple">couple</button>
                <button class="px-3 py-1.5 rounded-lg border bg-slate-50" data-cat="bedroom">bedroom</button>
                <button class="px-3 py-1.5 rounded-lg border bg-slate-50" data-cat="shower">shower</button>
                <button class="px-3 py-1.5 rounded-lg border bg-slate-50" data-cat="roleplay">roleplay</button>
                <button class="px-3 py-1.5 rounded-lg border bg-slate-50" data-cat="dance">dance</button>
              </div>
            </div>

            <div class="mt-4">
              <label class="text-sm font-medium">Aktive Kategorien</label>
              <div id="activeCats" class="mt-2 flex flex-wrap gap-2"></div>
            </div>

            <div class="flex gap-2 mt-3">
              <input id="catInput" class="flex-1" placeholder="Kategorie hinzufügen…" />
              <button id="addCat" class="px-3 py-2 rounded-lg border bg-slate-50">Add</button>
              <button id="clearCats" class="px-3 py-2 rounded-lg border">Clear</button>
            </div>

            <p class="text-xs text-slate-500 mt-3">Kategorien werden zur Prompt-Ergänzung genutzt und als Metadaten gespeichert.</p>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- Minimal JS for UX -->
  <script>
    // helpers
    const $ = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => Array.from(r.querySelectorAll(s));

    // preview meta updater
    function updateMeta(){
      $('#previewMeta').textContent =
        `${$('#resolution').value} • ${$('#fps').value}fps • ${$('#duration').value}s`;
    }
    ['resolution','fps','duration'].forEach(id=>$('#'+id).addEventListener('input', updateMeta));
    updateMeta();

    // swap image/video placeholder
    $('#swapPreview').addEventListener('click', () => {
      const v = $('#previewVideo');
      const img = $('#previewImage');
      if (v.classList.contains('hidden')) {
        v.src = ''; // no real media yet
        v.classList.remove('hidden'); img.classList.add('hidden');
      } else {
        v.pause(); v.classList.add('hidden'); img.classList.remove('hidden');
      }
    });

    $('#btnPlay').addEventListener('click', () => {
      const v = $('#previewVideo');
      if (v.classList.contains('hidden')) return;
      v.play().catch(()=>{});
    });

    // styles add/remove
    function makeRemovableChip(text, container){
      const span = document.createElement('span');
      span.className = 'chip';
      span.innerHTML = `<span>${text}</span><button aria-label="remove">&times;</button>`;
      span.querySelector('button').addEventListener('click', ()=> span.remove());
      container.appendChild(span);
    }
    $('#addStyle').addEventListener('click', () => {
      const val = $('#styleInput').value.trim();
      if (!val) return;
      makeRemovableChip(val, $('#styleChips'));
      $('#styleInput').value = '';
    });

    // categories logic
    const activeCats = new Set();
    function renderCats(){
      const wrap = $('#activeCats'); wrap.innerHTML = '';
      activeCats.forEach(c => makeRemovableChip(c, wrap));
    }
    $('#addCat').addEventListener('click', () => {
      const val = $('#catInput').value.trim();
      if (!val) return;
      activeCats.add(val); $('#catInput').value = ''; renderCats();
    });
    $('#clearCats').addEventListener('click', () => { activeCats.clear(); renderCats(); });
    $$('#quickCats button').forEach(b => b.addEventListener('click', () => {
      activeCats.add(b.dataset.cat); renderCats();
    }));

    // prompt submit (Ctrl+Enter)
    function buildRequest(){
      return {
        model: $('#model').value,
        aspect: $('#aspect').value,
        fps: +$('#fps').value,
        duration: +$('#duration').value,
        resolution: $('#resolution').value,
        quality: $('#quality').value,
        fov: $('#fov').value || null,
        camera_move: $('#camMove').value || null,
        styles: $$('#styleChips .chip span:first-child').map(s=>s.textContent),
        nsfw: $('#nsfw').checked,
        prompt: $('#prompt').value.trim(),
        negative: $('#neg').value.trim(),
        categories: Array.from(activeCats)
      };
    }
    function showStatus(msg, ok=true){
      const el = $('#status');
      el.textContent = msg;
      el.className = 'mt-3 text-sm ' + (ok ? 'text-emerald-600' : 'text-rose-600');
    }
    function fakeGenDelay(ms){ return new Promise(r=>setTimeout(r, ms)); }

    async function submitGeneration(){
      const payload = buildRequest();
      if (!payload.prompt){
        showStatus('Bitte Prompt eingeben.', false); return;
      }
      showStatus('Wird vorbereitet …');
      // hier später: fetch('/api/video/generate', {method:'POST', body: JSON.stringify(payload)})
      await fakeGenDelay(600);
      showStatus('Job übergeben (Demo). Antwort vom Backend hier einbinden.');
    }

    $('#btnGenerate').addEventListener('click', submitGeneration);
    $('#prompt').addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && e.ctrlKey) { e.preventDefault(); submitGeneration(); }
    });
    $('#btnStop').addEventListener('click', () => showStatus('Job gestoppt (Demo).', false));

    // download (Demo: aktuelle Preview)
    $('#btnDownload').addEventListener('click', () => {
      const link = document.createElement('a');
      link.href = $('#previewImage').src;
      link.download = 'preview.jpg';
      link.click();
    });
  </script>
</body>
</html>
